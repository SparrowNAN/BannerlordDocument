## åˆ›å»ºæ–°çš„å®šå±…ç‚¹

> æ¸¸æˆæ·»åŠ å®šå±…ç‚¹çš„æ–¹å¼æ˜¯é€šè¿‡ç»“åˆä¸¤ä¸ªåŸºäºXMLçš„æ–‡ä»¶ï¼šä¸€ä¸ªå®šä¹‰å®šå±…ç‚¹çš„ç±»å‹ï¼ˆè—èº«å¤„ï¼Œæ‘åº„ï¼ŒåŸé•‡ï¼ŒåŸå ¡ç­‰ï¼‰ï¼Œå®šå±…ç‚¹çš„`æ‰€æœ‰è€…`ä»¥åŠå…¶ä»–`ç›¸å…³å‚æ•°`ï¼Œä¾‹å¦‚ç¹è£ï¼Œç‰¹äº§ï¼Œæ‘åº„å±äºå“ªä¸ªåŸé•‡ç­‰ç­‰ã€‚è¿™äº›æ•°æ®ç»´æŠ¤åœ¨æ¸¸æˆä¸­çš„`Modules / SandBox / ModuleData / settlements.xml`æ–‡ä»¶ä¸­ã€‚åœ¨æ­¤æ–‡ä»¶æ—è¾¹æ˜¯ä¸€ä¸ªè·ç¦»ç¼“å­˜æ–‡ä»¶`Modules / SandBox / ModuleSata / Settlements_distance_cache.bin`ï¼Œå¯ä»¥ç”¨ä»£ç ç”Ÿæˆã€‚

> å®šå±…ç‚¹çš„`è§†è§‰æ•ˆæœ`çš„æè¿°ç»´æŠ¤åœ¨åœ¨`Modules / SandBox / SceneObj / Main_map / scene.xscene`æ–‡ä»¶ä¸­ã€‚

## æœ‰å…³å°†æ¥çš„SDKæ”¯æŒçš„è¯´æ˜

ä»ç›®å‰å¯ç”¨çš„DLLä¸­çš„ä»£ç ä¸­å¯ä»¥æ˜æ˜¾çœ‹å‡ºï¼Œåº”è¯¥ä½¿ç”¨ç¼–è¾‘å™¨æ¥è¿›è¡Œä¿®æ”¹å®šå±…ç‚¹ã€‚è¯¥ç¼–è¾‘å™¨å¯å¸®åŠ©æ”¾ç½®å®šå±…ç‚¹ï¼Œå®šä¹‰å…¶è§†è§‰æ•ˆæœå¹¶ç”Ÿæˆä¸Šè¿°è·ç¦»ç¼“å­˜ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¿™è¿˜ä¸å­˜åœ¨ï¼Œå› æ­¤å¿…é¡»è¯‰ä½¿ç”¨ä¿®æ”¹XMLæ–‡ä»¶çš„æ–¹å¼ä¿®æ”¹å®šå±…ç‚¹ã€‚

## æœ‰å…³è·ç¦»ç¼“å­˜çš„è¯´æ˜

ç›®å‰å°šä¸æ¸…æ¥šè·ç¦»ç¼“å­˜çš„å®é™…ä½œç”¨ã€‚å¦‚æœä¸è¿›è¡Œæ›´æ–°ï¼ŒAIä¼¼ä¹å¯ä»¥è®¿é—®æ›´å¤šçš„å®šå±…ç‚¹ï¼Œåœ¨é‚£é‡Œå¾å‹Ÿéƒ¨é˜Ÿï¼Œ å…³æŠ¼å›šçŠ¯å¹¶è´­ä¹°ç‰©å“ã€‚ç©å®¶ä¹Ÿå¯ä»¥è¾“å…¥æ–°çš„å®šå±…ç‚¹ã€‚è·ç¦»ç¼“å­˜å¯èƒ½ä¸æŸäº›AIå†³ç­–æœ‰å…³ï¼Œä½†å°šä¸æ¸…æ¥šã€‚è·ç¦»ç¼“å­˜æ˜¯ç”±`SettlementPositionScript`ä¸­çš„`SaveSettlementDistanceCache()`æ–¹æ³•åˆ›å»ºçš„ï¼Œè¯¥æ–¹æ³•æ˜¯å½“å‰æœªåœ¨æ¸¸æˆä¸­ä½¿ç”¨çš„ç±»ï¼Œè¯¥ç±»å¯èƒ½æºè‡ªä¸Šè¿°åœ°å›¾ç¼–è¾‘å™¨ã€‚å¯ä»¥åœ¨`SandBox.View.dll`ä¸­æ‰¾åˆ°è¯¥ç±»ã€‚

## å¦‚ä½•è¦†ç›–æ¸¸æˆä¸­é»˜è®¤çš„å®šå±…ç‚¹

> åˆ›å»ºMODçš„æ—¶å€™ï¼Œå¯ä»¥è¦†ç›–`SandBox`æ¨¡å—ä¸­çš„å®šå±…ç‚¹çš„æ•°æ®ï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œå¢é‡çš„ä¿®æ”¹ï¼Œåªèƒ½è¿›è¡Œå…¨éƒ¨çš„è¦†ç›–ã€‚

1. é¦–å…ˆå°† ```Modules / SandBox / ModuleData / settlements.xml``` å¤åˆ¶åˆ° `Modules / ä½ çš„MODç›®å½• / ModuleData / settlements.xml` ä»¥åŠå¤åˆ¶ `Modules / SandBox / SceneObj / Main_mapï¼ˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰` åˆ° `Modules / ä½ çš„MODç›®å½• / SceneObj / Main_map`ã€‚

Tips: è¯·ä¸è¦ä½¿ç”¨å¸¸è§„çš„è®°äº‹æœ¬è¿›è¡ŒXMLç¼–è¾‘ï¼ˆå¯¹çš„ï¼Œè¯´çš„å°±æ˜¯windowsçš„è®°äº‹æœ¬ï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨é€‚å½“çš„XMLç¼–è¾‘å·¥å…·æˆ–åŠŸèƒ½æ›´å¼ºå¤§çš„æ–‡æœ¬ç¼–è¾‘å™¨(å¦‚[`Notepad++`](https://notepad-plus.en.softonic.com/))

2. ä¿®æ”¹MODçš„`submodule.xml`
```xml
    -- ç›´æ¥æ·»åŠ ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•å†…å®¹ï¼ˆé™¤äº†è¿™å¥æ³¨é‡Šï¼‰
	<XmlNode>
			<XmlName id="Settlements" path="settlements"/>
			<IncludeGameTypes>
				<GameType value = "Campaign"/>
				<GameType value = "CampaignStoryMode"/>
			</IncludeGameTypes>
	</XmlNode> 	
```
ç°åœ¨ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„æƒ³æ³•åœ¨å¤åˆ¶å‡ºæ¥çš„`settlements.xml`æ–‡ä»¶ä¸­æ·»åŠ /ä¿®æ”¹å®šå±…ç‚¹çš„ç›¸å…³é…ç½®äº†ï¼Œ**ä½†æ˜¯è¦ä¿è¯æ–‡ä»¶ä¸­æ¯ä¸ªæ¡ç›®éƒ½è¦æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ID**ã€‚

åœ¨æ‚¨çš„mods`Main_map / scene.xscene`æ–‡ä»¶ä¸­ï¼Œå¯¹`settlements.xml`æ–‡ä»¶ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½éœ€è¦ä¸€ä¸ª`game_entity`ï¼Œä»ç„¶è¦ç¡®ä¿æ²¡æœ‰é‡å¤çš„IDã€‚

>ä¸¾ä¸ªğŸŒ° -- [æ·»åŠ ä¸€ä¸ªåŸé•‡å’Œä¸¤ä¸ªæ‘åº„](https://pastebin.com/BuSbQ6x2) ä»¥åŠ[scene.xsceneä¸­æ·»åŠ game_entity](https://pastebin.com/dXcKT7wf)

3. å…¶å®ƒè¯´æ˜

```shell
# æ‘åº„è¢«ç»‘å®šåˆ°ä¸€ä¸ªåŸé•‡
trade_bound="Settlement.town_M1" bound="Settlement.town_M1"
# ç°åœ¨è¿˜ä¸æ¸…æ¥š`trade_bound`å’Œ`bound`æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®‰å…¨èµ·è§ï¼Œè¯·è®¾ç½®æˆç›¸åŒçš„ä¸€ä¸ª

# æŒ‡å®šæ‘åº„çš„ç‰¹äº§
# æ‘åº„ç±»å‹åœ¨`Modules / SandBox / ModuleData / spprojects.xml`ä¸­å®šä¹‰
village_type="VillageType.fisherman"
```
